(window["jsonp-common-entrypoints"]=window["jsonp-common-entrypoints"]||[]).push([["auto/bootstrap/category-nav/v2/nav"],{"g/Ib":function(t,e,a){"use strict";a.r(e);var i=a("BIVT");var n=a.n(i);var o=a("vBnV");var r=a("V9r9");var s={setMenubarKeyboardNavigation:function t(e){function a(t){var a=t.attr("id");e.attr("aria-activedescendant",a);t.trigger("focus")}if("menubar"!==e.attr("role"))throw new Error("".concat(e,' must have a role set to "menubar".'));var i=e.find('[role="menuitem"]').filter(":not(:disabled)").filter(":not(:hidden)");e.off("keydown.a11yMenubarFocus");e.on("keydown.a11yMenubarFocus",(function(t){if(t.keyCode===r["a"].RIGHT||t.keyCode===r["a"].LEFT){t.preventDefault();var e=n()(document.activeElement);var o=i.index(e);if(t.keyCode===r["a"].LEFT){if(0===o){a(i.eq(i.length-1));return}a(i.eq(o-1))}if(t.keyCode===r["a"].RIGHT){if(o===i.length-1){a(i.first());return}a(i.eq(o+1))}}if(t.keyCode===r["a"].ENTER||t.keyCode===r["a"].SPACE||t.keyCode===r["a"].DOWN){t.preventDefault();n()(t.target).trigger("menubar-item-press")}}))}};var v=a("E1kl");var c=a("H3fw");var u=a("YrzB");var d=a("+s1y");function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function N(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,i.key,i)}}function h(t,e,a){e&&N(t.prototype,e);a&&N(t,a);Object.defineProperty(t,"prototype",{writable:false});return t}function f(t,e,a){e in t?Object.defineProperty(t,e,{value:a,enumerable:true,configurable:true,writable:true}):t[e]=a;return t}var A={TOP_NAV_CATEGORY_LIST:'[data-ui="top-nav-category-list"]',TOP_NAV_CATEGORY_LINK:'[data-ui="top-nav-category-link"]',TOP_NAV_PROMO_LINK:'[data-ui="top-nav-promo-link"]',ONSALE_LINK:'[data-ui="desktop-catnav-onsale-link"]',PROMO:'[data-ui="promo"]',SUB_NAV:'[data-ui="sub-nav"]',SIDE_NAV_CATEGORY_LIST:'[data-ui="side-nav-category-list"]',SIDE_NAV_CATEGORY_LINK:'[data-ui="side-nav-category-link"]',TERTIARY_NAV:'[data-ui="tertiary-nav"]',TERTIARY_NAV_PROMO_LINK:'[data-ui="tertiary-nav-promo-link"]',MENUITEM:'[role="menuitem"]',MENU:'[role="menu"]',ACTIVE_NAV_ITEM_INDICATOR:'[data-ui="active-nav-item-indicator"]'};var m={DISPLAY_NONE:"wt-display-none"};var _={MOUSE_LEAVE_TIMEOUT:400,MOUSE_ENTER_TIMEOUT:350,MOUSE_ENTER_DROPDOWN_DELAY:200};var E=function(){function t(e){l(this,t);f(this,"$context",void 0);f(this,"$topNavCategoryList",void 0);f(this,"$navCategoryLinks",void 0);f(this,"$navPromoLinks",void 0);f(this,"allNavLinks",void 0);f(this,"storedNavItemPositionAndWidthInfo",void 0);f(this,"$sideNavCategoryList",void 0);f(this,"$sideNavCategoryLinks",void 0);f(this,"$tertiaryNavs",void 0);f(this,"$searchResults",void 0);f(this,"$promos",void 0);f(this,"$activeNavItemIndicator",void 0);f(this,"mouseEnterNavItemTimeout",void 0);f(this,"leaveNavTimeout",void 0);this.$context=e;this.$topNavCategoryList=this.$context.find(A.TOP_NAV_CATEGORY_LIST);this.$navCategoryLinks=this.$context.find(A.TOP_NAV_CATEGORY_LINK);this.$navPromoLinks=this.$context.find(A.TOP_NAV_PROMO_LINK);this.allNavLinks=this.getAllNavLinks();this.storedNavItemPositionAndWidthInfo=this.setStoredNavItemPositionAndWidthInfo();this.$sideNavCategoryList=this.$context.find(A.SIDE_NAV_CATEGORY_LIST);this.$sideNavCategoryLinks=this.$context.find(A.SIDE_NAV_CATEGORY_LINK);this.$tertiaryNavs=this.$context.find(A.TERTIARY_NAV);this.$searchResults=n()(".gnav-search-inner").find("[data-id='search-suggestions']");this.$promos=this.$context.find(A.PROMO);this.$activeNavItemIndicator=this.$context.find(A.ACTIVE_NAV_ITEM_INDICATOR);this.mouseEnterNavItemTimeout=null;this.leaveNavTimeout=null;this.bindEvents()}h(t,[{key:"bindEvents",value:function t(){this.$context.on("mouseenter",A.SUB_NAV,this.onMouseEnterNav.bind(this)).on("mouseenter",A.TOP_NAV_CATEGORY_LIST,this.onMouseEnterNav.bind(this)).on("mouseenter",A.SUB_NAV,this.clearMouseEnterNavItem.bind(this)).on("mouseenter click",A.TOP_NAV_CATEGORY_LINK,this.onMouseEnterNavItem.bind(this)).on("click",A.ONSALE_LINK,(function(){c["default"].logEvent({event_name:"desktop_nav_onsale_click"})})).on("mouseleave",A.SUB_NAV,this.onMouseLeaveNav.bind(this)).on("mouseleave",A.TOP_NAV_CATEGORY_LIST,this.onMouseLeaveNav.bind(this)).on("mouseenter",A.TOP_NAV_PROMO_LINK,this.onMouseEnterPromoItem.bind(this)).on("click",A.TOP_NAV_PROMO_LINK,(function(t){var e=n()(t.currentTarget).data("eventName");c["default"].logEvent({event_name:"nav_promo_click",promo_name:e})})).on("click",A.TERTIARY_NAV_PROMO_LINK,(function(t){var e=n()(t.currentTarget).data("nodeId");c["default"].logEvent({event_name:"tertiary_nav_promo_click",node_id:e})})).on("click",A.SIDE_NAV_CATEGORY_LINK,this.onMouseClickSideNavItem.bind(this));this.$sideNavCategoryList.menuAim({activate:this.onMouseEnterSideNavItem.bind(this),deactivate:n.a.noop,submenuSelector:"li"});this.setA11yInitialStateMenubar().bindA11yEvents().bindA11yEventsSideNav().bindA11yEventsTertiaryNav().bindGetNavItemInfoOnWindowResize()}},{key:"bindNavClickLogEvents",value:function t(e,a){var i=n()(e.currentTarget).data("linkable");i?c["default"].logEvent({event_name:"top_nav_linkable_onclick",node_id:a}):c["default"].logEvent({event_name:"top_nav_not_linkable_onclick",node_id:a})}},{key:"onMouseEnterNav",value:function t(){this.clearLeaveNavTimeout()}},{key:"onMouseEnterNavItem",value:function t(e){var a=this;var i=n()(e.currentTarget);var o=i.data("node-id");var r=this.hasActiveTopNavLink()?_.MOUSE_ENTER_DROPDOWN_DELAY:_.MOUSE_ENTER_TIMEOUT;this.clearMouseEnterNavItem();this.$searchResults.hide();"click"===e.type&&this.bindNavClickLogEvents(e,o);this.mouseEnterNavItemTimeout=window.setTimeout((function(){a.makeActiveNavItem(i).hide(A.SUB_NAV).show(A.SUB_NAV+a.getDataAttributeString(o)).activateSubNav(o,false)}),r)}},{key:"onKeyActivateTopNavItem",value:function t(e){var a=e.data("node-id");var i=A.SUB_NAV+this.getDataAttributeString(a);this.clearMouseEnterNavItem().makeActiveNavItem(e).hide(A.SUB_NAV).show(i).activateSubNav(a,true)}},{key:"activateSubNav",value:function t(e,a){var i=A.SUB_NAV+this.getDataAttributeString(e);var n=this.getFirstFocusableChildForSelector("".concat(i," ").concat(A.SIDE_NAV_CATEGORY_LINK)).parent("li");if(n.length){this.makeSideNavItemActive(n).setAriaActiveDescendant("".concat(i," ").concat(A.SIDE_NAV_CATEGORY_LIST),n.attr("id"));a&&this.setMenuKeyboardNavigation("".concat(i," ").concat(A.SIDE_NAV_CATEGORY_LIST)).getFirstFocusableChildForSelector("".concat(i," ").concat(A.SIDE_NAV_CATEGORY_LIST)).trigger("focus")}else{i=A.TERTIARY_NAV+this.getDataAttributeString(e);this.show(i);a&&this.setMenuKeyboardNavigation(i).getFirstFocusableChildForSelector(i).trigger("focus")}return this}},{key:"onMouseEnterPromoItem",value:function t(e){this.clearLeaveNavTimeout().makeActiveNavItem(n()(e.currentTarget)).clearMouseEnterNavItem().hide(A.SUB_NAV)}},{key:"onMouseLeaveNav",value:function t(){var e=this;this.clearLeaveNavTimeout().clearMouseEnterNavItem();this.leaveNavTimeout=window.setTimeout((function(){e.shrinkActiveNavItemIndicator();e.clearActiveNavItems().hide(A.SUB_NAV)}),_.MOUSE_LEAVE_TIMEOUT)}},{key:"onMouseEnterSideNavItem",value:function t(e){this.clearMouseEnterNavItem().makeSideNavItemActive(n()(e))}},{key:"onMouseClickSideNavItem",value:function t(e){var a=n()(e.currentTarget);this.clearMouseEnterNavItem().makeSideNavItemActive(a)}},{key:"bindGetNavItemInfoOnWindowResize",value:function t(){var e=this;window.addEventListener("resize",Object(d["a"])((function(){e.storedNavItemPositionAndWidthInfo=e.setStoredNavItemPositionAndWidthInfo()}),200))}},{key:"clearLeaveNavTimeout",value:function t(){if(this.leaveNavTimeout){window.clearTimeout(this.leaveNavTimeout);this.leaveNavTimeout=null}return this}},{key:"clearMouseEnterNavItem",value:function t(){if(this.mouseEnterNavItemTimeout){window.clearTimeout(this.mouseEnterNavItemTimeout);this.mouseEnterNavItemTimeout=null}return this}},{key:"getAllNavLinks",value:function t(){return Array.from(this.$navCategoryLinks).concat(Array.from(this.$navPromoLinks)).map((function(t){return n()(t)}))}},{key:"setStoredNavItemPositionAndWidthInfo",value:function t(){return this.allNavLinks.map((function(t){return{data:t.data(),width:t.width(),position:t.position()}}))}},{key:"getStoredNavItemPositionAndWidthInfo",value:function t(e){return this.storedNavItemPositionAndWidthInfo.find((function(t){return t.data===(null===e||void 0===e?void 0:e.data())}))}},{key:"getDataAttributeString",value:function t(e){return'[data-node-id="'.concat(e,'"]')}},{key:"hasActiveTopNavLink",value:function t(){return this.$navCategoryLinks.filter(".active").length>0||this.$navPromoLinks.filter(".active").length>0}},{key:"getActiveTopNavLink",value:function t(){return this.allNavLinks.find((function(t){return n()(t).hasClass("active")}))}},{key:"getFirstFocusableChildForSelector",value:function t(e){return this.$context.find("".concat(e," ").concat(A.MENUITEM)).first()}},{key:"makeSideNavItemActive",value:function t(e){Math.random()<.01&&u["a"].increment("nav.category.open.sub_category");var a=e.data("node-id");if("A"===e.children().first().get(0).tagName)return this;this.clearActiveSideNavItems();e.addClass("active");this.hide(A.TERTIARY_NAV).show(A.TERTIARY_NAV+this.getDataAttributeString(a)).setMenuKeyboardNavigation(A.TERTIARY_NAV+this.getDataAttributeString(a));return this}},{key:"makeActiveNavItem",value:function t(e){Math.random()<.01&&u["a"].increment("nav.category.open.top_category");this.makeActiveNavItemIndicator(e);return this}},{key:"makeActiveNavItemIndicator",value:function t(e){var a=this.getStoredNavItemPositionAndWidthInfo(e)||{width:0,position:{left:0,top:0}};var i=a.width;var n=a.position;if(this.hasActiveTopNavLink()){this.clearActiveNavItems();e.addClass("active");this.$activeNavItemIndicator.addClass("animate-all").css("left",n.left).css("width",i)}else{e.addClass("active");var o=n.left+.5*i;this.$activeNavItemIndicator.css("left",o).css("width",i)}}},{key:"shrinkActiveNavItemIndicator",value:function t(){var e=this.getActiveTopNavLink();var a=this.getStoredNavItemPositionAndWidthInfo(e);if(!a)return;var i=a.width;var n=a.position;var o=n.left+.5*i;this.$activeNavItemIndicator.css("left",o).removeClass("animate-all").css("width",0)}},{key:"clearActiveNavItems",value:function t(){this.$navCategoryLinks.removeClass("active");this.$navPromoLinks.removeClass("active");return this}},{key:"clearActiveSideNavItems",value:function t(){this.$sideNavCategoryLinks.removeClass("active");return this}},{key:"show",value:function t(e){this.$context.find(e).removeClass(m.DISPLAY_NONE).attr("aria-hidden","false");return this}},{key:"hide",value:function t(e){this.$context.find(e).addClass(m.DISPLAY_NONE).attr("aria-hidden","true");return this}},{key:"focus",value:function t(e){this.$context.find("".concat(e," ").concat(A.MENUITEM)).trigger("focus");return this}},{key:"onTabAway",value:function t(){this.clearLeaveNavTimeout().clearMouseEnterNavItem().clearActiveNavItems().hide(A.SUB_NAV)}},{key:"setAriaActiveDescendant",value:function t(e,a){this.$context.find(e).parent("ul").attr("aria-activedescendant",a);return this}},{key:"setMenuKeyboardNavigation",value:function t(e){v["a"].setMenuKeyboardNavigation(this.$context.find(e),{shiftTabTriggersLeave:true});return this}},{key:"setA11yInitialStateMenubar",value:function t(){var e=this.$navCategoryLinks.find(A.MENUITEM);var a=e.first();a.attr("tabindex","0");this.$topNavCategoryList.attr("aria-activedescendant",a.attr("id"));return this}},{key:"bindA11yEvents",value:function t(){var e=this;if(!this.$topNavCategoryList||this.$topNavCategoryList.length<1)return this;s.setMenubarKeyboardNavigation(this.$topNavCategoryList);this.$context.on("keydown.catnav",(function(t){e.$searchResults.hide();t.keyCode!==r["a"].TAB||t.shiftKey||e.onTabAway()}));this.$topNavCategoryList.on("menubar-item-press",A.MENUITEM,(function(t){var a=n()(t.currentTarget);if("true"===a.attr("aria-haspopup")){var i=a.closest('[data-ui="top-nav-category-link"]');e.onKeyActivateTopNavItem(i)}else a.attr("href")&&"#"!==a.attr("href")&&window.location.assign(a.attr("href"))}));return this}},{key:"bindA11yEventsSideNav",value:function t(){var e=this;this.$sideNavCategoryList.on("menu-item-open-submenu menu-item-activate",A.MENUITEM,(function(t){var a=n()(t.target);if("true"===a.attr("aria-haspopup")){var i=a.parent("li");var o=i.data("node-id");e.makeSideNavItemActive(i).getFirstFocusableChildForSelector(A.TERTIARY_NAV+e.getDataAttributeString(o)).trigger("focus")}else"menu-item-activate"===t.type&&a.attr("href")&&"#"!==a.attr("href")&&window.location.assign(a.attr("href"))}));this.$sideNavCategoryList.on("menu-item-leave",A.MENUITEM,(function(t){var a=n()(t.target);var i=a.parents("ul").data("node-id");e.hide(A.SUB_NAV).clearActiveNavItems().focus(A.TOP_NAV_CATEGORY_LINK+e.getDataAttributeString(i))}));return this}},{key:"bindA11yEventsTertiaryNav",value:function t(){var e=this;this.$tertiaryNavs.on("menu-item-leave",A.MENUITEM,(function(t){var a=n()(t.target);var i=a.parents(A.TERTIARY_NAV);var o=i.data("node-id");var r=i.attr("data-has-side-nav");if("false"===r){e.hide(A.SUB_NAV).clearActiveNavItems().focus(A.TOP_NAV_CATEGORY_LINK+e.getDataAttributeString(o));return}e.focus(A.SIDE_NAV_CATEGORY_LINK+e.getDataAttributeString(o))}));this.$tertiaryNavs.on("menu-item-activate",A.MENUITEM,(function(t){window.location.assign(n()(t.target).attr("href"))}));this.$tertiaryNavs.on("menu-item-open-submenu menu-item-activate",A.MENUITEM,(function(t){var e=n()(t.target);var a=e.closest(A.MENU);var i=a.siblings(A.PROMO);i.find(":focusable").eq(0).trigger("focus")}));this.$promos.on("keyup",(function(t){var a=n()(t.target);if(t.keyCode===r["a"].LEFT||t.shiftKey&&t.keyCode===r["a"].TAB){t.preventDefault();var i=a.closest(A.PROMO);var o=i.siblings(A.TERTIARY_NAV).filter(":not(:hidden)");o.find(":focusable").eq(0).trigger("focus")}else if(t.keyCode===r["a"].ESC){t.preventDefault();var s=a.closest(A.SUB_NAV).data("node-id");e.hide(A.SUB_NAV).clearActiveNavItems().focus(A.TOP_NAV_CATEGORY_LINK+e.getDataAttributeString(s))}}));return this}}]);return t}();var I=E;var T=a("/wG7");var g={KEY:"catnav",NAME:"CategoryNav_V2_ApiSpec_SubNav"};var y={CAT_NAV:'[id="desktop-category-nav"]',TOP_NAV_LIST:'[data-ui="top-nav-category-list"]',SUB_NAV_CONTAINER:'[data-ui="sub-nav-container"]',SUB_NAV:'[data-ui="sub-nav"]',GIFT_GUIDE_TREATMENT:"[data-cyber-gift-guide-treatment]",SALE_PROMO_TREATMENT:"[data-cyber-sale-treatment]",SALE_PROMO_CONTROL:"[data-cyber-sale-control]"};var k=n()(y.CAT_NAV);var S=k.find(y.TOP_NAV_LIST);var L=k.find(y.SUB_NAV);var O=k.find(y.GIFT_GUIDE_TREATMENT);var b=k.find(y.SALE_PROMO_TREATMENT);var M=k.find(y.SALE_PROMO_CONTROL);O.on("click",(function(){c["default"].logEvent({event_name:"catnav_gifts_clicked"})}));b.on("click",(function(){c["default"].logEvent({event_name:"catnav_saletreatment_clicked"})}));M.on("click",(function(){c["default"].logEvent({event_name:"catnav_salecontrol_clicked"})}));if((null===S||void 0===S?void 0:S.children().length)>0)if(0===L.length){var C=T["a"].getSpecArgsForSpec(g.NAME,y.CAT_NAV);T["a"].fetchOne(g.KEY,g.NAME,C,"GET",true).done((function(t){var e;null===k||void 0===k||null===(e=k.find("".concat(y.SUB_NAV_CONTAINER," ").concat(T["a"].DEFAULT_PLACEHOLDER_SELECTOR)))||void 0===e?void 0:e.replaceWith(t.output[g.KEY]);new I(k)}))}else new I(k)}}]);
//# sourceMappingURL=https://jsproxy.c.etsy-syseng-gke-prod.etsycloud.com/primary/en-US/async/common-entrypoints/auto/bootstrap/category-nav/v2/nav.3788250d523f777afec2.js.map